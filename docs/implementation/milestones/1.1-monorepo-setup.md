# Milestone 1.1: Monorepo + Basic SvelteKit App

**Goal**: Get studypuck.app loading with basic SvelteKit app from monorepo structure  
**Status**: üîÑ In Progress  
**Branch**: `feature/impl1.1`  
**Prerequisites**: [Manual Setup Required](#manual-setup-prerequisites)

## Milestone Overview

This milestone establishes the foundation:
- Migrate to monorepo structure (PNPM + Turborepo)
- Create basic SvelteKit app with Cloudflare adapter
- Deploy to studypuck.app via Cloudflare Pages
- Verify deployment pipeline works

## Manual Setup Prerequisites

‚ö†Ô∏è **HUMAN TASKS REQUIRED** - Complete these before code implementation:

### 1. Cloudflare Pages Setup
See: [../setup/cloudflare-setup.md](../setup/cloudflare-setup.md)
- [ ] Create Cloudflare Pages project connected to GitHub
- [ ] Configure custom domain `studypuck.app`
- [ ] Set build configuration

### 2. GitHub Actions Setup  
See: [../setup/github-setup.md](../setup/github-setup.md)
- [ ] Create Cloudflare API token
- [ ] Add repository secrets (API token + Account ID)

**üõë STOP**: Complete manual setup before proceeding to implementation

---

## Implementation Tasks

*Execute these tasks after manual setup is complete*

### Task 1: Monorepo Migration
**Reference**: `/docs/specs/monorepo-structure-design.md`

1. **Install monorepo tooling**
   ```bash
   npm install -g pnpm
   pnpm add -D turbo
   ```

2. **Create workspace structure**
   ```
   StudyPuck/
   ‚îú‚îÄ‚îÄ apps/
   ‚îÇ   ‚îî‚îÄ‚îÄ web/          # SvelteKit app
   ‚îú‚îÄ‚îÄ packages/         # Shared packages
   ‚îú‚îÄ‚îÄ docs/            # Documentation
   ‚îú‚îÄ‚îÄ package.json     # Root workspace config
   ‚îú‚îÄ‚îÄ pnpm-workspace.yaml
   ‚îî‚îÄ‚îÄ turbo.json       # Turborepo config
   ```

3. **Configure workspace files**
   - Root `package.json` with workspace configuration
   - `pnpm-workspace.yaml` defining workspace structure
   - `turbo.json` with build pipeline configuration

### Task 2: SvelteKit App Creation

1. **Create SvelteKit app in `/apps/web/`**
   ```bash
   cd apps
   pnpm create sveltekit@latest web
   cd web
   pnpm add -D @sveltejs/adapter-cloudflare
   ```

2. **Configure Cloudflare adapter**
   - Update `svelte.config.js` with Cloudflare adapter
   - Set output directory to `build`

3. **Create basic "Hello StudyPuck" page**
   - Replace default content with StudyPuck branding
   - Add basic layout and styling foundation

### Task 3: Build Pipeline Setup

1. **Configure Turborepo scripts**
   - `turbo build` builds all apps/packages
   - `turbo dev` runs development servers
   - `turbo test` runs all test suites (for future use)

2. **Test local build**
   ```bash
   pnpm turbo build --filter=web
   ```

3. **Verify build output**
   - Check `/apps/web/build/` contains static files
   - Ensure Cloudflare Pages compatibility

### Task 4: GitHub Actions Pipeline

1. **Create `.github/workflows/deploy.yml`**
   - Trigger on push to `main` and pull requests
   - Install dependencies with PNPM
   - Build with Turborepo
   - Deploy to Cloudflare Pages (main branch only)

2. **Test pipeline**
   - Push to feature branch, verify build works
   - Merge to main, verify deployment to studypuck.app

## Success Criteria

- [ ] **Monorepo structure** established with PNPM + Turborepo
- [ ] **SvelteKit app** runs locally at `localhost:5173`
- [ ] **Build pipeline** produces static files in `/apps/web/build/`
- [ ] **studypuck.app loads** with "Hello StudyPuck" content
- [ ] **GitHub Actions** builds and deploys automatically
- [ ] **Repository structure** matches monorepo design specification

## Verification Steps

1. **Local Development**
   ```bash
   pnpm turbo dev --filter=web
   # Visit localhost:5173, verify "Hello StudyPuck" loads
   ```

2. **Local Build**
   ```bash
   pnpm turbo build --filter=web
   # Check apps/web/build/ contains index.html and assets
   ```

3. **Production Deployment**
   - Visit `https://studypuck.app`
   - Verify content loads correctly
   - Check browser developer tools for errors

## Troubleshooting

**Build Issues**:
- Check `apps/web/svelte.config.js` Cloudflare adapter configuration
- Verify `pnpm-workspace.yaml` includes `apps/*`
- Ensure `turbo.json` has correct build dependencies

**Deployment Issues**:
- Check Cloudflare Pages build logs
- Verify GitHub repository secrets are set
- Confirm build output directory is `apps/web/build`

**Domain Issues**:
- Check Cloudflare DNS settings for `studypuck.app`
- Verify custom domain is properly configured in Pages project

## Next Milestone

Upon completion: [Milestone 1.2: Authentication Integration](1.2-authentication.md)

## Files Created/Modified

- `/package.json` - Root workspace configuration
- `/pnpm-workspace.yaml` - Workspace definition  
- `/turbo.json` - Build pipeline configuration
- `/apps/web/` - SvelteKit application directory
- `/apps/web/svelte.config.js` - Cloudflare adapter configuration
- `/.github/workflows/deploy.yml` - CI/CD pipeline